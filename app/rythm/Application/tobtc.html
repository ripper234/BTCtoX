@import java.math.BigDecimal;
@import java.math.RoundingMode;
@extends(main)
@set(title = "Convert BTC to other currencies")
@args BigDecimal btcRate, Map rates

<div class="container">

    <p><input id="amount" class='amount' name="amount" placeholder='0.00' autofocus >
        <select id="to" name="to" class="currency" >
            @for(Map.Entry rate : rates.entrySet()) {
                <option value="@rate.getValue()">@rate.getKey() ($@(new BigDecimal(1).divide((BigDecimal)rate.getValue(), 3, RoundingMode.HALF_UP)))</option>
            }
        </select>
        = <span class="result">0.00</span> BTC
    </p>

    <p>1 BTC = @btcRate.toString() USD</p>
    <script type="text/javascript">
        function update() {
            var amount = $("#amount").val();
            var toRate = $("#to").val();
            var btcRate = @(btcRate.toString());
            $(".result").text((amount / toRate / btcRate).toFixed(3));
        }

        $("#to").change(update);
        $("#amount")
            .keydown(function(){setTimeout(update, 0)});

    </script>
</div>